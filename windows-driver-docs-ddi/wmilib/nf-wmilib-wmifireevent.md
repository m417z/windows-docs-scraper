# WmiFireEvent function

## Description

The **WmiFireEvent** routine sends an event to WMI for delivery to data consumers that have requested notification of the event.

## Parameters

### `DeviceObject` [in]

A pointer to the driver's [DEVICE_OBJECT](https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_object).

### `Guid` [in]

A pointer to the GUID that represents the event block.

### `InstanceIndex` [in]

If the event block has multiple instances, specifies the index of the instance.

### `EventDataSize` [in]

Specifies the number of bytes of data at *EventData*. If no data is generated for an event, *EventData* must be zero.

### `EventData` [in, optional]

A pointer to a driver-allocated nonpaged buffer containing data generated by the driver for the event. If no data is generated for an event, *EventData* must be **NULL**. WMI frees the buffer without further intervention by the driver.

## Return value

**WmiFireEvent** propagates the status returned by [IoWmiWriteEvent](https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iowmiwriteevent), or returns STATUS_INSUFFICIENT_RESOURCES if it could not allocate memory for the event.

## Remarks

A driver calls **WmiFireEvent** to send an event to WMI for delivery to all data consumers that have requested notification of the event. All pointers passed to **WmiFireEvent** must point to nonpagable memory, such as nonpaged pool.

The driver sends an event only if it has been previously enabled by the driver's [DpWmiFunctionControl](https://learn.microsoft.com/windows-hardware/drivers/ddi/wmilib/nc-wmilib-wmi_function_control_callback) routine, which WMI calls to process an **IRP_MN_ENABLE_EVENT** request.

The driver writes any data associated with the event to the buffer at *EventData*. WMI fills in a [WNODE_SINGLE_INSTANCE](https://learn.microsoft.com/windows-hardware/drivers/ddi/wmistr/ns-wmistr-tagwnode_single_instance) structure with the data and calls [IoWmiWriteEvent](https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iowmiwriteevent) to deliver the event.

For more information about event tracing, see [WMI Event Tracing](https://learn.microsoft.com/windows-hardware/drivers/kernel/wmi-event-tracing).

## See also

[DpWmiFunctionControl](https://learn.microsoft.com/windows-hardware/drivers/ddi/wmilib/nc-wmilib-wmi_function_control_callback)

[IRP_MN_ENABLE_EVENTS](https://learn.microsoft.com/windows-hardware/drivers/kernel/irp-mn-enable-events)

[WmiSystemControl](https://learn.microsoft.com/windows-hardware/drivers/ddi/wmilib/nf-wmilib-wmisystemcontrol)