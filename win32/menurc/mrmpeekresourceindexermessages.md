# MrmPeekResourceIndexerMessages function

Retrieves diagnostic messages generated by a resource indexer. These may help in debugging problems with the indexer,
although not all errors are reported.

## Parameters

*indexer* \[in\]

Type: **[**MrmResourceIndexerHandle**](https://learn.microsoft.com/windows/win32/menurc/mrmresourceindexerhandle)**

A handle identifying the resource indexer to retrieve messages from. This handle is returned via a call to
[**MrmCreateResourceIndexer**](https://learn.microsoft.com/windows/win32/menurc/mrmcreateresourceindexer) or one of the related **MrmCreateResourceIndexer...*** functions.

*messages* \[out\]

Type: **[**MrmResourceIndexerMessage**](https://learn.microsoft.com/windows/win32/menurc/mrmresourceindexermessage)\*\***

The address of an [**MrmResourceIndexerMessage**](https://learn.microsoft.com/windows/win32/menurc/mrmresourceindexermessage) pointer. On successful return, contains an
array of **MrmResourceIndexerMessage** structures.

*numMsgs* \[out\]

Type: **ULONG\***

The number of messages returned in *messages*.

## Return value

Type: **HRESULT**

S\_OK if the function succeeded, otherwise some other value. Use the **SUCCEEDED** or **FAILED** macros (defined in winerror.h)
to determine success or failure.

## Remarks

Do not free the memory pointed to by \**messages* as it is owned by the indexer. The memory will automatically be freed
when calling [**MrmDestroyIndexerAndMessages**](https://learn.microsoft.com/windows/win32/menurc/mrmdestroyindexerandmessages) after you have finished using the indexer.

## Requirements

| Requirement | Value |
|-------------------------------------|-------------------------------------------------------------------------------------------------|
| Minimum supported client<br> | Windows 10, version 1803 \[desktop apps only\]<br> |
| Minimum supported server<br> | Windows Server \[desktop apps only\]<br> |
| Header<br> | MrmResourceIndexer.h |
| Library<br> | Mrmsupport.lib |
| DLL<br> | Mrmsupport.dll |

## See also

[**MrmResourceIndexerMessage**](https://learn.microsoft.com/windows/win32/menurc/mrmresourceindexermessage)

[Package resource indexing (PRI) APIs and custom build systems](https://learn.microsoft.com/windows/uwp/app-resources/pri-apis-custom-build-systems)