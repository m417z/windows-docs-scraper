# MsiProcessAdvertiseScriptW function

## Description

The
**MsiProcessAdvertiseScript** function processes an advertise script file into the specified locations.

## Parameters

### `szScriptFile` [in]

The full path to a script file generated by
[MsiAdvertiseProduct](https://learn.microsoft.com/windows/desktop/api/msi/nf-msi-msiadvertiseproducta) or
[MsiAdvertiseProductEx](https://learn.microsoft.com/windows/desktop/api/msi/nf-msi-msiadvertiseproductexa).

### `szIconFolder` [in]

An optional path to a folder in which advertised icon files and transform files are located. If this parameter is **NULL**, no icon or transform files are written.

### `hRegData` [in]

A registry key under which registry data is to be written. If this parameter is **NULL**, the installer writes the registry data under the appropriate key, based on whether the advertisement is per-user or per-machine. If this parameter is non-**NULL**, the script will write the registry data under the specified registry key rather than the normal location. In this case, the application will not get advertised to the user.

### `fShortcuts` [in]

**TRUE** if shortcuts should be created. If a special folder is returned by
[SHGetSpecialFolderLocation](https://learn.microsoft.com/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation) it will hold the shortcuts.

### `fRemoveItems` [in]

**TRUE** if specified items are to be removed instead of created.

## Return value

| Value | Meaning |
| --- | --- |
| **ERROR_SUCCESS** | The function completed successfully. |
| **ERROR_ACCESS_DENIED** | The calling process was not running under the LocalSystem account. |
| **An error relating to an action** | See [Error Codes](https://learn.microsoft.com/windows/desktop/Msi/error-codes). |
| **[Initialization Error](https://learn.microsoft.com/windows/desktop/Msi/initialization-errors)** | An error relating to initialization occurred. |
| **ERROR_CALL_NOT_IMPLEMENTED** | This function is not available for this platform. |

## Remarks

The process calling this function must be running under the LocalSystem account. To advertise an application for per-user installation to a targeted user, the thread that calls this function must impersonate the targeted user. If the thread calling this function is not impersonating a targeted user, the application is advertised to all users for installation with elevated privileges.

> [!NOTE]
> The msi.h header defines MsiProcessAdvertiseScript as an alias that automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that is not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see [Conventions for Function Prototypes](https://learn.microsoft.com/windows/win32/intl/conventions-for-function-prototypes).