# IRDPSRAPIViewer::Connect

## Description

[The [IRDPSRAPIViewer](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nn-rdpencomapi-irdpsrapiviewer) interface is no longer available for use for UWP applications as of Windows 10, version 1709. It is still supported for Desktop apps.]

Starts the actual connection to the sharer.

## Parameters

### `bstrConnectionString` [in]

Type: **BSTR**

The connection string used to connect to the sharer and authenticate the viewer.

### `bstrName` [in]

Type: **BSTR**

Name for the viewer. The name is sent to the sharer and other viewers. The string is limited to 255 characters.

### `bstrPassword` [in]

Type: **BSTR**

Password used for authentication. The password is sent out-of-band from the sharer.

## Return value

Type: **HRESULT**

If the method succeeds, the return value is **S_OK**. Otherwise, the return value is an error code.

## Remarks

The connection string contained in the *bstrConnectionString* parameter is generated by the sharer and obtained by the viewer by completing the following steps:

1. The sharer obtains an instance of the [IRDPSRAPIInvitationManager](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nn-rdpencomapi-irdpsrapiinvitationmanager) interface from the [IRDPSRAPISharingSession::Invitations](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nf-rdpencomapi-irdpsrapisharingsession-get_invitations) property.
2. The sharer obtains an instance of the [IRDPSRAPIInvitation](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nn-rdpencomapi-irdpsrapiinvitation) interface by calling the [IRDPSRAPIInvitationManager::CreateInvitation](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nf-rdpencomapi-irdpsrapiinvitationmanager-createinvitation) method.
3. The sharer obtains the connection string from the [IRDPSRAPIInvitation::ConnectionString](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nf-rdpencomapi-irdpsrapiinvitation-get_connectionstring) property.
4. The sharer sends the connection string to the viewer in an application-defined method, such as storing the connection string in a file and sharing the file with the viewer.

For increased security, applications can associate passwords with an invitation on the sharer side. Such passwords are usually distributed to viewers through some mechanism other than the one that is used to send the connection string. This is to prevent network "sniffing" types of attacks. If an invitation has a password associated with it, the password must be passed in through this API. Otherwise, the attendee will be disconnected.

The *bstrName* string that is set in this property is sent to the sharer after the connection is started. The property is a friendly name that the sharer application can choose to display. The property is useful when an invitation is used to authenticate multiple attendees because it allows the sharer and the other viewers to identify who is participating in a Windows Desktop Sharing session.

## See also

[IRDPSRAPIViewer](https://learn.microsoft.com/windows/desktop/api/rdpencomapi/nn-rdpencomapi-irdpsrapiviewer)