# ResUtilGetPropertiesToParameterBlock function

## Description

Retrieves properties specified by a [property table](https://learn.microsoft.com/previous-versions/windows/desktop/mscs/property-tables) from the [cluster database](https://learn.microsoft.com/previous-versions/windows/desktop/mscs/cluster-database) and returns them in a [parameter block](https://learn.microsoft.com/previous-versions/windows/desktop/mscs/parameter-blocks).

## Parameters

### `hkeyClusterKey` [in]

Pointer to the cluster database key that identifies the location of the properties to retrieve.

### `pPropertyTable` [in]

Pointer to an array of [RESUTIL_PROPERTY_ITEM](https://learn.microsoft.com/previous-versions/windows/desktop/api/resapi/ns-resapi-resutil_property_item) structures that describes the properties to process.

### `pOutParams` [out]

Pointer to the output parameter block to fill.

### `bCheckForRequiredProperties` [in]

Specifies whether an error should be generated if required properties are missing.

### `pszNameOfPropInError` [out, optional]

Address of the string pointer in which to return the name of the error generated by a missing required property. The *ppszNameOfPropInError* property is optional.

## Return value

If the operations succeeds, the function returns **ERROR_SUCCESS**.

If the operation fails,
the function returns a [system error code](https://learn.microsoft.com/windows/desktop/Debug/system-error-codes). The following are possible error codes.

| Return code | Description |
| --- | --- |
| **ERROR_BAD_ARGUMENTS** | One or more of the input parameters were invalid. |
| **ERROR_NOT_ENOUGH_MEMORY** | There was an error allocating memory. |

## Remarks

With the **ResUtilGetPropertiesToParameterBlock** utility function, the property table pointed to by *pPropertyTable* can include default values.

## See also

[RESUTIL_PROPERTY_ITEM](https://learn.microsoft.com/previous-versions/windows/desktop/api/resapi/ns-resapi-resutil_property_item)