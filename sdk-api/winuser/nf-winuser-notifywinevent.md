# NotifyWinEvent function

## Description

Signals the system that a predefined event occurred. If any client applications have registered a hook function for the event, the system calls the client's hook function.

## Parameters

### `event` [in]

Type: **[DWORD](https://learn.microsoft.com/windows/desktop/WinProg/windows-data-types)**

Specifies the event that occurred. This value must be one of the [event constants](https://learn.microsoft.com/windows/desktop/WinAuto/event-constants).

### `hwnd` [in]

Type: **[HWND](https://learn.microsoft.com/windows/desktop/WinProg/windows-data-types)**

Handle to the window that contains the object that generated the event.

### `idObject` [in]

Type: **[LONG](https://learn.microsoft.com/windows/desktop/WinProg/windows-data-types)**

Identifies the object that generated the event. This value is either one of the predefined [object identifiers](https://learn.microsoft.com/windows/desktop/WinAuto/object-identifiers) or a custom object ID value.

### `idChild` [in]

Type: **[LONG](https://learn.microsoft.com/windows/desktop/WinProg/windows-data-types)**

Identifies whether the event was generated by an object or by a child element of the object. If this value is CHILDID_SELF, the event was generated by the object itself. If not CHILDID_SELF, this value is the child ID of the element that generated the event.

## Remarks

Servers call this function to notify the system that an event has occurred. Microsoft Active Accessibility checks to see if any client applications have set hook procedures for the event and, if so, calls the appropriate hook procedures.

If no hook procedures are registered for the event, the performance penalty for calling this function is minor.

Servers call **NotifyWinEvent** to announce the event to the system after the event has occurred; they must never notify the system of an event before the event has occurred.

When the client's hook procedure is called, it receives a number of parameters that describe the event and the object that generated the event. The hook procedure uses the [AccessibleObjectFromEvent](https://learn.microsoft.com/windows/desktop/api/oleacc/nf-oleacc-accessibleobjectfromevent) function to retrieve a pointer to the [IAccessible](https://learn.microsoft.com/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object that generated the event.

Servers may receive a [WM_GETOBJECT](https://learn.microsoft.com/windows/win32/winauto/wm-getobject) message immediately after calling this function. This can happen if there are any in-context clients that call [AccessibleObjectFromEvent](https://learn.microsoft.com/windows/desktop/api/oleacc/nf-oleacc-accessibleobjectfromevent) in the event callback.

When servers call this function, they must be ready to handle [WM_GETOBJECT](https://learn.microsoft.com/windows/win32/winauto/wm-getobject), return an [IAccessible](https://learn.microsoft.com/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer, and handle any of the **IAccessible** methods.

**Note to Server Developers:** When you call **NotifyWinEvent**, if any clients are listening for that event in-context, their event handlers, which typically send [WM_GETOBJECT](https://learn.microsoft.com/windows/win32/winauto/wm-getobject) and call [IAccessible](https://learn.microsoft.com/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods, will execute before **NotifyWinEvent** returns. When you call **NotifyWinEvent**, you should be prepared to handle these calls, if they occur. If you need to do extra setup to allow for this, you should do so before you call **NotifyWinEvent**, not after.

## See also

[AccessibleObjectFromEvent](https://learn.microsoft.com/windows/desktop/api/oleacc/nf-oleacc-accessibleobjectfromevent)

[SetWinEventHook](https://learn.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwineventhook)

[UnHookWinEvent](https://learn.microsoft.com/windows/desktop/api/winuser/nf-winuser-unhookwinevent)

[WinEvents](https://learn.microsoft.com/windows/desktop/WinAuto/winevents-infrastructure)