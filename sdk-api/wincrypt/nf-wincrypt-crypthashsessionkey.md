# CryptHashSessionKey function

## Description

**Important** This API is deprecated. New and existing software should start using [Cryptography Next Generation APIs.](https://learn.microsoft.com/windows/desktop/SecCNG/cng-portal) Microsoft may remove this API in future releases.

The **CryptHashSessionKey** function computes the cryptographic [hash](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly) of a [session key](https://learn.microsoft.com/windows/desktop/SecGloss/s-gly) object. This function can be called multiple times with the same hash handle to compute the [hash](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly) of multiple keys. Calls to **CryptHashSessionKey** can be interspersed with calls to
[CryptHashData](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashdata).

Before calling this function,
[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash) must be called to create the handle of a [hash object](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly).

## Parameters

### `hHash` [in]

A handle to the [hash object](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly).

### `hKey` [in]

A handle to the key object to be hashed.

### `dwFlags` [in]

The following flag value is defined.

| Value | Meaning |
| --- | --- |
| **CRYPT_LITTLE_ENDIAN**<br><br>0x00000001 | When this flag is set, the bytes of the key are hashed in [little-endian](https://learn.microsoft.com/windows/desktop/SecGloss/l-gly) form. Note that by default (when *dwFlags* is zero), the bytes of the key are hashed in [big-endian](https://learn.microsoft.com/windows/desktop/SecGloss/b-gly) form. |

## Return value

If the function succeeds, the return value is **TRUE**.

If the function fails, the return value is **FALSE**. For extended error information, call
[GetLastError](https://learn.microsoft.com/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror).

The error codes prefaced by "NTE" are generated by the particular CSP you are using. Some possible error codes follow.

| Return code | Description |
| --- | --- |
| **ERROR_INVALID_HANDLE** | One of the parameters specifies a handle that is not valid. |
| **ERROR_INVALID_PARAMETER** | One of the parameters contains a value that is not valid. This is most often a pointer that is not valid. |
| **NTE_BAD_ALGID** | The *hHash* handle specifies an algorithm that this CSP does not support. |
| **NTE_BAD_FLAGS** | The *dwFlags* parameter is nonzero. |
| **NTE_BAD_HASH** | The hash object specified by the *hHash* parameter is not valid. |
| **NTE_BAD_HASH_STATE** | An attempt was made to add data to a hash object that is already marked "finished." |
| **NTE_BAD_KEY** | A keyed hash algorithm is being used, but the session key is no longer valid. This error is generated if the session key is destroyed before the hashing operation is complete. |
| **NTE_BAD_UID** | The CSP context that was specified when the hash object was created cannot be found. |
| **NTE_FAIL** | The function failed in some unexpected way. |

## See also

[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash)

[CryptGenKey](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptgenkey)

[CryptHashData](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashdata)

[Hash and Digital Signature Functions](https://learn.microsoft.com/windows/desktop/SecCrypto/cryptography-functions)