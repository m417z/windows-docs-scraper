# CryptSetHashParam function

## Description

**Important** This API is deprecated. New and existing software should start using [Cryptography Next Generation APIs.](https://learn.microsoft.com/windows/desktop/SecCNG/cng-portal) Microsoft may remove this API in future releases.

The **CryptSetHashParam** function customizes the operations of a [hash object](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly), including setting up initial hash contents and selecting a specific hashing algorithm.

## Parameters

### `hHash` [in]

A handle to the hash object on which to set parameters.

### `dwParam` [in]

This parameter can be one of the following values.

| Value | Meaning |
| --- | --- |
| **HP_HMAC_INFO.** | A pointer to an [HMAC_INFO](https://learn.microsoft.com/windows/desktop/api/wincrypt/ns-wincrypt-hmac_info) structure that specifies the cryptographic hash algorithm and the inner and outer strings to be used. |
| **HP_HASHVAL.** | A byte array that contains a hash value to place directly into the hash object. Before setting this value, the size of the hash value must be determined by using the [CryptGetHashParam](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptgethashparam) function to read the HP_HASHSIZE value.<br><br>Some [cryptographic service providers](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly) (CSPs) do not support this capability. |

**Note** Some CSP types can add additional values that can be set by using this function.

### `pbData` [in]

A value data buffer. Place the value data in this buffer before calling **CryptSetHashParam**. The form of this data varies, depending on the value number.

### `dwFlags` [in]

This parameter is reserved for future use and must be set to zero.

## Return value

If the function succeeds, the function returns **TRUE**.

If the function fails, it returns **FALSE**. For extended error information, call
[GetLastError](https://learn.microsoft.com/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror).

The error codes prefaced by "NTE" are generated by the particular CSP you are using. Some possible error codes follow.

| Return code | Description |
| --- | --- |
| **ERROR_INVALID_HANDLE** | One of the parameters specifies a handle that is not valid. |
| **ERROR_BUSY** | The CSP context is currently being used by another [process](https://learn.microsoft.com/windows/desktop/SecGloss/p-gly). |
| **ERROR_INVALID_PARAMETER** | One of the parameters contains a value that is not valid. This is most often a pointer that is not valid. |
| **NTE_BAD_FLAGS** | The *dwFlags* parameter is nonzero or the *pbData* buffer contains a value that is not valid. |
| **NTE_BAD_HASH** | The hash object specified by the *hHash* parameter is not valid. |
| **NTE_BAD_TYPE** | The *dwParam* parameter specifies an unknown value. |
| **NTE_BAD_UID** | The CSP context that was specified when the *hKey* key was created cannot be found. |
| **NTE_FAIL** | The function failed in some unexpected way. |

## Remarks

Occasionally, a hash value that has been generated elsewhere must be signed. This can be done by using the following sequence of operations:

1. Create a hash object by using
   [CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash).
2. Set the HP_HASHVAL value.
3. Sign the hash value by using
   [CryptSignHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptsignhasha) and obtain a digital signature block.
4. Destroy the hash object by using
   [CryptDestroyHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptdestroyhash).

## See also

[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash)

[CryptDestroyHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptdestroyhash)

[CryptGetHashParam](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptgethashparam)

[CryptSetKeyParam](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptsetkeyparam)

[CryptSignHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptsignhasha)

[HMAC_INFO](https://learn.microsoft.com/windows/desktop/api/wincrypt/ns-wincrypt-hmac_info)

[Hash and Digital Signature Functions](https://learn.microsoft.com/windows/desktop/SecCrypto/cryptography-functions)