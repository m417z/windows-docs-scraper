# CryptHashData function

## Description

**Important** This API is deprecated. New and existing software should start using [Cryptography Next Generation APIs.](https://learn.microsoft.com/windows/desktop/SecCNG/cng-portal) Microsoft may remove this API in future releases.

The **CryptHashData** function adds data to a specified [hash object](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly). This function and
[CryptHashSessionKey](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashsessionkey) can be called multiple times to compute the hash of long or discontinuous data streams.

Before calling this function,
[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash) must be called to create a handle of a hash object.

## Parameters

### `hHash` [in]

Handle of the hash object.

### `pbData` [in]

A pointer to a buffer that contains the data to be added to the hash object.

### `dwDataLen` [in]

Number of bytes of data to be added. This must be zero if the CRYPT_USERDATA flag is set.

### `dwFlags` [in]

The following flag values are defined.

| Value | Meaning |
| --- | --- |
| **CRYPT_OWF_REPL_LM_HASH**<br><br>0x00000001 | This flag is not used. |
| **CRYPT_USERDATA**<br><br>1 (0x1) | All Microsoft Cryptographic Providers ignore this parameter. For any CSP that does not ignore this parameter, if this flag is set, the CSP prompts the user to input data directly. This data is added to the hash. The application is not allowed access to the data. This flag can be used to allow the user to enter a PIN into the system. |

## Return value

If the function succeeds, the return value is **TRUE**.

If the function fails, the return value is **FALSE**. For extended error information, call
[GetLastError](https://learn.microsoft.com/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror).

The error codes prefaced by "NTE" are generated by the particular CSP you are using. Some possible error codes follow.

| Return code | Description |
| --- | --- |
| **ERROR_INVALID_HANDLE** | One of the parameters specifies a handle that is not valid. |
| **ERROR_INVALID_PARAMETER** | One of the parameters contains a value that is not valid. This is most often a pointer that is not valid. |
| **NTE_BAD_ALGID** | The *hHash* handle specifies an algorithm that this CSP does not support. |
| **NTE_BAD_FLAGS** | The *dwFlags* parameter contains a value that is not valid. |
| **NTE_BAD_HASH** | The hash object specified by the *hHash* parameter is not valid. |
| **NTE_BAD_HASH_STATE** | An attempt was made to add data to a hash object that is already marked "finished." |
| **NTE_BAD_KEY** | A keyed hash algorithm is being used, but the session key is no longer valid. This error is generated if the session key is destroyed before the hashing operation is complete. |
| **NTE_BAD_LEN** | The CSP does not ignore the CRYPT_USERDATA flag, the flag is set, and the *dwDataLen* parameter has a nonzero value. |
| **NTE_BAD_UID** | The CSP context that was specified when the hash object was created cannot be found. |
| **NTE_FAIL** | The function failed in some unexpected way. |
| **NTE_NO_MEMORY** | The CSP ran out of memory during the operation. |

## See also

[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash)

[CryptHashSessionKey](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashsessionkey)

[CryptSignHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptsignhasha)

[Hash and Digital Signature Functions](https://learn.microsoft.com/windows/desktop/SecCrypto/cryptography-functions)