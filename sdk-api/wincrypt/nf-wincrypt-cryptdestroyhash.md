# CryptDestroyHash function

## Description

**Important** This API is deprecated. New and existing software should start using [Cryptography Next Generation APIs.](https://learn.microsoft.com/windows/desktop/SecCNG/cng-portal) Microsoft may remove this API in future releases.

The **CryptDestroyHash** function destroys the [hash object](https://learn.microsoft.com/windows/desktop/SecGloss/h-gly) referenced by the *hHash* parameter. After a hash object has been destroyed, it can no longer be used.

To help ensure security, we recommend that hash objects be destroyed after they have been used.

## Parameters

### `hHash` [in]

The handle of the hash object to be destroyed.

## Return value

If the function succeeds, the return value is nonzero.

If the function fails, the return value is zero. For extended error information, call
[GetLastError](https://learn.microsoft.com/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror).

The error codes prefaced by "NTE" are generated by the particular [cryptographic service provider](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly) (CSP) you are using. Some possible error codes follow.

| Return code | Description |
| --- | --- |
| **ERROR_BUSY** | The hash object specified by *hHash* is currently being used and cannot be destroyed. |
| **ERROR_INVALID_HANDLE** | The *hHash* parameter specifies a handle that is not valid. |
| **ERROR_INVALID_PARAMETER** | The *hHash* parameter contains a value that is not valid. |
| **NTE_BAD_ALGID** | The *hHash* handle specifies an algorithm that this CSP does not support. |
| **NTE_BAD_HASH** | The hash object specified by the *hHash* parameter is not valid. |
| **NTE_BAD_UID** | The CSP context that was specified when the hash object was created cannot be found. |

## Remarks

When a hash object is destroyed, many CSPs overwrite the memory in the CSP where the hash object was held. The CSP memory is then freed.

There should be a one-to-one correspondence between calls to
[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash) and **CryptDestroyHash**.

All hash objects that have been created by using a specific CSP must be destroyed before that CSP handle is released with the [CryptReleaseContext](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptreleasecontext) function.

#### Examples

For an example that uses the **CryptDestroyHash** function, see [Example C Program: Creating and Hashing a Session Key](https://learn.microsoft.com/windows/desktop/SecCrypto/example-c-program-creating-and-hashing-a-session-key).

## See also

[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash)

[CryptHashData](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashdata)

[CryptSignHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptsignhasha)

[Hash and Digital Signature Functions](https://learn.microsoft.com/windows/desktop/SecCrypto/cryptography-functions)