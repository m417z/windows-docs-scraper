# CryptGetHashParam function

## Description

**Important** This API is deprecated. New and existing software should start using [Cryptography Next Generation APIs.](https://learn.microsoft.com/windows/desktop/SecCNG/cng-portal) Microsoft may remove this API in future releases.

The **CryptGetHashParam** function retrieves data that governs the operations of a hash object. The actual hash value can be retrieved by using this function.

## Parameters

### `hHash` [in]

Handle of the hash object to be queried.

### `dwParam` [in]

Query type. This parameter can be set to one of the following queries.

| Value | Meaning |
| --- | --- |
| **HP_ALGID**<br><br>Hash algorithm | An [ALG_ID](https://learn.microsoft.com/windows/desktop/SecCrypto/alg-id) that indicates the algorithm specified when the hash object was created. For a list of hash algorithms, see [CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash). |
| **HP_HASHSIZE**<br><br>Hash value size | **DWORD** value indicating the number of bytes in the hash value. This value will vary depending on the hash algorithm. Applications must retrieve this value just before the HP_HASHVAL value so the correct amount of memory can be allocated. |
| **HP_HASHVAL**<br><br>Hash value | The hash value or message hash for the hash object specified by *hHash*. This value is generated based on the data supplied to the hash object earlier through the [CryptHashData](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashdata) and [CryptHashSessionKey](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashsessionkey) functions.<br><br>The **CryptGetHashParam** function completes the hash. After **CryptGetHashParam** has been called, no more data can be added to the hash. Additional calls to [CryptHashData](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashdata) or [CryptHashSessionKey](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashsessionkey) fail. After the application is done with the hash, [CryptDestroyHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptdestroyhash) should be called to destroy the hash object. |

**Note** CSPs can add more values that this function can query.

### `pbData` [out]

A pointer to a buffer that receives the specified value data. The form of this data varies, depending on the value number.

This parameter can be **NULL** to determine the memory size required.

### `pdwDataLen` [in, out]

A pointer to a **DWORD** value specifying the size, in bytes, of the *pbData* buffer. When the function returns, the **DWORD** value contains the number of bytes stored in the buffer.

If *pbData* is **NULL**, set the value of *pdwDataLen* to zero.

**Note** When processing the data returned in the buffer, applications must use the actual size of the data returned. The actual size can be slightly smaller than the size of the buffer specified on input. (On input, buffer sizes are usually specified large enough to ensure that the largest possible output data fits in the buffer.) On output, the variable pointed to by this parameter is updated to reflect the actual size of the data copied to the buffer.

### `dwFlags` [in]

Reserved for future use and must be zero.

## Return value

If the function succeeds, the return value is **TRUE**.

If the function fails, the return value is **FALSE**. For extended error information, call
[GetLastError](https://learn.microsoft.com/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror).

The error codes prefaced by "NTE" are generated by the particular CSP you are using. Some possible error codes follow.

| Return code | Description |
| --- | --- |
| **ERROR_INVALID_HANDLE** | One of the parameters specifies a handle that is not valid. |
| **ERROR_INVALID_PARAMETER** | One of the parameters contains a value that is not valid. This is most often a pointer that is not valid. |
| **ERROR_MORE_DATA** | If the buffer specified by the *pbData* parameter is not large enough to hold the returned data, the function sets the ERROR_MORE_DATA code and stores the required buffer size, in bytes, in the variable pointed to by *pdwDataLen*. |
| **NTE_BAD_FLAGS** | The *dwFlags* parameter is nonzero. |
| **NTE_BAD_HASH** | The hash object specified by the *hHash* parameter is not valid. |
| **NTE_BAD_TYPE** | The *dwParam* parameter specifies an unknown value number. |
| **NTE_BAD_UID** | The CSP context that was specified when the hash was created cannot be found. |

## See also

[ALG_ID](https://learn.microsoft.com/windows/desktop/SecCrypto/alg-id)

[CryptCreateHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptcreatehash)

[CryptDestroyHash](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptdestroyhash)

[CryptGetKeyParam](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptgetkeyparam)

[CryptHashData](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashdata)

[CryptHashSessionKey](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-crypthashsessionkey)

[CryptSetHashParam](https://learn.microsoft.com/windows/desktop/api/wincrypt/nf-wincrypt-cryptsethashparam)

[Hash and Digital Signature Functions](https://learn.microsoft.com/windows/desktop/SecCrypto/cryptography-functions)