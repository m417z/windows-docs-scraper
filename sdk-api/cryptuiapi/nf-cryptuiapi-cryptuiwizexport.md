# CryptUIWizExport function

## Description

The **CryptUIWizExport** function exports a [certificate](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly), a [certificate trust list](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly) (CTL), a [certificate revocation list](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly) (CRL), or a [certificate store](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly) to a file. The export can be performed with or without user interaction.

## Parameters

### `dwFlags` [in]

 Contains flags that modify the behavior of the function. This can be zero or a combination of one or more of the following values.

**Note** Except for **CRYPTUI_WIZ_NO_UI**, none of the following constants are defined in a published header file. To use these constants, you must define them by using the specified values.

| Value | Meaning |
| --- | --- |
| **CRYPTUI_WIZ_NO_UI**<br><br>0x0001 | This function will perform the export based on the information in the [CRYPTUI_WIZ_EXPORT_INFO](https://learn.microsoft.com/windows/desktop/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_info) structure pointed to by *pExportInfo* without displaying any user interface. If this flag is not specified, this function will display a wizard to guide the user through the export process. |
| **CRYPTUI_WIZ_IGNORE_NO_UI_FLAG_FOR_CSPS**<br><br>0x0002 | Suppress all user interfaces generated by [cryptographic service providers](https://learn.microsoft.com/windows/desktop/SecGloss/c-gly) (CSPs). This option can be overridden by the **CRYPTUI_WIZ_NO_UI_EXCEPT_CSP** option. |
| **CRYPTUI_WIZ_NO_UI_EXCEPT_CSP**<br><br>0x0003 | Suppress all user interfaces except those generated by CSPs. This option overrides the **CRYPTUI_WIZ_IGNORE_NO_UI_FLAG_FOR_CSPS** option. |
| **CRYPTUI_WIZ_EXPORT_PRIVATE_KEY**<br><br>0x0100 | Skip the **Export Private Key** page and assume that the [private key](https://learn.microsoft.com/windows/desktop/SecGloss/p-gly) is to be exported. |
| **CRYPTUI_WIZ_EXPORT_NO_DELETE_PRIVATE_KEY**<br><br>0x0200 | Disable the **Delete the private key** check box in the **Export File Format** page. |

### `hwndParent` [in]

The handle of the window to use as the parent of the dialog box that this function creates. This parameter is ignored if the **CRYPT_WIZ_NO_UI** flag is set in *dwFlags*.

### `pwszWizardTitle` [in]

A pointer to a null-terminated Unicode string that contains the title to use in the dialog box that this function creates. This parameter is ignored if the **CRYPT_WIZ_NO_UI** flag is set in *dwFlags*.

### `pExportInfo` [in]

A pointer to a [CRYPTUI_WIZ_EXPORT_INFO](https://learn.microsoft.com/windows/desktop/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_info) structure that contains information about producing the export wizard.

### `pvoid` [in]

If the **dwSubjectChoice** member of the [CRYPTUI_WIZ_EXPORT_INFO](https://learn.microsoft.com/windows/win32/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_certcontext_info) structure that *pExportInfo* references is **CRYPTUI_WIZ_EXPORT_CERT_CONTEXT**, and if the **CRYPTUI_WIZ_NO_UI** flag is set in *dwFlags*, this parameter is a pointer to a [CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO](https://learn.microsoft.com/windows/desktop/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_certcontext_info) structure.

If the **CRYPTUI_WIZ_NO_UI** flag is not set in *dwFlags*, this parameter is optional and can be **NULL**. If this parameter is not **NULL**, the [CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO](https://learn.microsoft.com/windows/win32/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_certcontext_info) structure contains the values that are displayed to the user as the default choices.

## Return value

If the function succeeds, the function returns nonzero.

If the function fails, it returns zero. For extended error information, call
the [GetLastError](https://learn.microsoft.com/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function.

## See also

[CRYPTUI_WIZ_EXPORT_CERTCONTEXT_INFO](https://learn.microsoft.com/windows/win32/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_certcontext_info)

[CRYPTUI_WIZ_EXPORT_INFO](https://learn.microsoft.com/windows/desktop/api/cryptuiapi/ns-cryptuiapi-cryptui_wiz_export_info)

[CryptUIWizImport](https://learn.microsoft.com/windows/desktop/api/cryptuiapi/nf-cryptuiapi-cryptuiwizimport)