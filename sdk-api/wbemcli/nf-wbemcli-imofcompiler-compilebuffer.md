# IMofCompiler::CompileBuffer

## Description

The **IMofCompiler::CompileBuffer** method compiles either a buffer containing binary MOF data or a text buffer in ASCII format. Binary MOF files contain parsed data and must be stored in the database.
The **CompileBuffer** method only accepts multi-byte character arrays (string buffers) that are not **NULL**-terminated.

## Parameters

### `BuffSize` [in]

Size of the data pointed to by the *pBuffer* parameter.

### `pBuffer` [in]

Pointer to the binary MOF file data or a text buffer in ASCII format.

### `ServerAndNamespace` [in]

Name of the server and namespace.

This parameter is ignored unless the *pBuffer* parameter points to a text buffer. If the text MOF is passed without a [#pragma](https://learn.microsoft.com/windows/desktop/WmiSdk/-pragma) statement, then the MOF file is compiled into the default namespace. If *pBuffer* points to a binary MOF file, then the *ServerAndNamespace* parameter must be **NULL**.

### `User` [in]

Name of the user requesting the service.

This parameter specifies the credentials for compiling on remote computers. If the value is **NULL**, then the user context is whatever the current process is using. This is always ignored when connecting to the local computer. For more information, see the Remarks section.

### `Authority` [in]

Specifies the credentials for compiling on remote computers. If the value is **NULL**, the authority context is whatever the current process is using. This parameter is always ignored when connecting to the local computer. For more information, see the Remarks section.

### `Password` [in]

Specifies the credentials for compiling on remote computers. If the value is **NULL**, the password of the current context is used. This parameter is always ignored when connecting to the local computer.

### `lOptionFlags` [in]

You can combine one or more of the following flags.

#### WBEM_FLAG_CHECK_ONLY

Performs only a syntax check.

#### WBEM_FLAG_AUTORECOVER

If the method is successful, it adds the file name to the list of files to be compiled during automatic database recovery.

This flag cannot be combined with the namespace, class, or instance flags.

#### WBEM_FLAG_CONSOLE_PRINT

Sends various useful messages to the console.

#### WBEM_FLAG_DONT_ADD_TO_LIST

Prevents the addition of the file to the list of files to be compiled during automatic database recovery.

This flag is not compatible with **WBEM_FLAG_AUTORECOVER**.

### `lClassFlags` [in]

This parameter is ignored because the binary MOF file already contains the information. The parameter value should be 0.

### `lInstanceFlags` [in]

Ignored because the binary MOF file already contains the information. The parameter value should be 0.

### `pInfo` [in, out]

Pointer to a [WBEM_COMPILE_STATUS_INFO](https://learn.microsoft.com/windows/win32/api/wbemcli/ns-wbemcli-wbem_compile_status_info) that describes an error.

If the parameter value is not **NULL**, an error has occurred, and the structure is filled with error information.

## Return value

This method returns **WBEM_S_NO_ERROR** if successful. If the method is unsuccessful, it returns **WBEM_S_FALSE**.

## Remarks

If the *User* parameter takes the form <*domain\user*>, the *Authority* parameter must be **NULL**.

Binary MOF data can be generated by the
[CreateBMOF](https://learn.microsoft.com/windows/desktop/api/wbemcli/nf-wbemcli-imofcompiler-createbmof) method, which stores the binary MOF data into a file that can be read before calling the
**CompileBuffer** method.

## See also

[IMofCompiler](https://learn.microsoft.com/windows/desktop/api/wbemcli/nn-wbemcli-imofcompiler)

[WBEM_COMPILER_OPTIONS](https://learn.microsoft.com/windows/win32/api/wbemcli/ne-wbemcli-wbem_compiler_options)