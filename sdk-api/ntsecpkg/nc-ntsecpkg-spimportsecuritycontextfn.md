# SpImportSecurityContextFn callback function

## Description

The **SpImportSecurityContext** function imports a security context from another process.

The **SpImportSecurityContext** function is the dispatch function for the
[ImportSecurityContext](https://learn.microsoft.com/windows/desktop/api/sspi/nf-sspi-importsecuritycontexta) function of the
[Security Support Provider Interface](https://learn.microsoft.com/windows/desktop/SecAuthN/sspi).

## Parameters

### `pPackedContext` [in]

Pointer to a
[SecBuffer](https://learn.microsoft.com/windows/desktop/api/sspi/ns-sspi-secbuffer) structure containing a [serialized](https://learn.microsoft.com/windows/desktop/SecGloss/s-gly) [security context](https://learn.microsoft.com/windows/desktop/SecGloss/s-gly) previously generated by the
[SpExportSecurityContext](https://learn.microsoft.com/windows/desktop/api/ntsecpkg/nc-ntsecpkg-spexportsecuritycontextfn) function.

### `Token` [in]

Optional. Handle to the context token.

### `phContext` [out]

Pointer to an **LSA_SEC_HANDLE** that receives the imported context handle.

## Return value

If the function succeeds, return STATUS_SUCCESS.

If the function fails, return an **NTSTATUS** code that indicates the reason it failed.

## Remarks

SSP/APs must implement the **SpImportSecurityContext** function; however, the actual name given to the implementation is up to the developer.

A pointer to the **SpImportSecurityContext** function is available in the
[SECPKG_USER_FUNCTION_TABLE](https://learn.microsoft.com/windows/desktop/api/ntsecpkg/ns-ntsecpkg-secpkg_user_function_table) structure received from the
[SpUserModeInitialize](https://learn.microsoft.com/windows/desktop/api/ntsecpkg/nc-ntsecpkg-spusermodeinitializefn) function.

## See also

[SECPKG_USER_FUNCTION_TABLE](https://learn.microsoft.com/windows/desktop/api/ntsecpkg/ns-ntsecpkg-secpkg_user_function_table)

[SpExportSecurityContext](https://learn.microsoft.com/windows/desktop/api/ntsecpkg/nc-ntsecpkg-spexportsecuritycontextfn)

[SpUserModeInitialize](https://learn.microsoft.com/windows/desktop/api/ntsecpkg/nc-ntsecpkg-spusermodeinitializefn)