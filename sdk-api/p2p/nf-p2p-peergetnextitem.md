# PeerGetNextItem function

## Description

The **PeerGetNextItem** function returns a specific number of items from a peer enumeration.

## Parameters

### `hPeerEnum` [in]

Handle to the peer enumeration from which items are retrieved. This handle is generated by a peer enumeration function.

### `pCount` [in, out]

Pointer to an integer that specifies the number of items to be retrieved from the peer enumeration. When returned, it contains the number of items in *ppvItems*. This parameter cannot be **NULL**.

### `pppvItems` [out]

Receives a pointer to an array of pointers to the next *pCount* items in the peer enumeration. The data, for example, a record or member information block, depends on the actual peer enumeration type.

## Return value

Returns **S_OK** if the operation succeeds. Otherwise, the function returns one of the following values.

| Return code | Description |
| --- | --- |
| **E_INVALIDARG** | One of the parameters is not valid. |
| **E_OUTOFMEMORY** | There is not enough memory to perform a specified operation. |

## Remarks

The **PeerGetNextItem** function returns the following:

* Items that are equal to or less than the amount specified in *pCount*.
* A list of items that are less than the amount specified when the amount is greater than the number of items available.

**Note** For example, when the inbound value of *pCount* is 10 and the remainder of the enumeration is 5 items, only 5 items are returned and the value pointed to by *pCount* is set to 5.

All items returned must be freed by passing a pointer to the array of pointers to the [PeerFreeData](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peerfreedata) function.

The end of an enumeration is indicated when the function returns with the *pCount* parameter set to zero (0).

## See also

[PeerEnumGroups](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peerenumgroups)

[PeerEnumIdentities](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peerenumidentities)

[PeerGetEndEnumeration](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peerendenumeration)

[PeerGetItemCount](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peergetitemcount)

[PeerGroupEnumConnections](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peergroupenumconnections)

[PeerGroupEnumMembers](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peergroupenummembers)

[PeerGroupEnumRecords](https://learn.microsoft.com/windows/desktop/api/p2p/nf-p2p-peergroupenumrecords)