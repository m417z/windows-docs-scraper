# IOleLink::GetSourceDisplayName

## Description

Retrieves the display name of the link source of the linked object.

## Parameters

### `ppszDisplayName` [out]

Address of a pointer variable that receives a pointer to the display name of the link source. If an error occurs, *ppszDisplayName* is set to **NULL**; otherwise, the implementation must use [IMalloc::Alloc](https://learn.microsoft.com/windows/desktop/api/objidl/nf-objidl-imalloc-alloc) to allocate the string returned in *ppszDisplayName*, and the caller is responsible for calling [IMalloc::Free](https://learn.microsoft.com/windows/desktop/api/objidl/nf-objidl-imalloc-free) to free it. Both caller and called use the allocator returned by [CoGetMalloc](https://learn.microsoft.com/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc).

## Return value

This method returns S_OK on success. Other possible return values include the following.

| Return code | Description |
| --- | --- |
| **E_FAIL** | The operation failed. |

Retrieving the display name requires calling these functions; therefore, this method may return errors generated by [CreateBindCtx](https://learn.microsoft.com/windows/desktop/api/objbase/nf-objbase-createbindctx) and [IMoniker::GetDisplayName](https://learn.microsoft.com/windows/desktop/api/objidl/nf-objidl-imoniker-getdisplayname).

## Remarks

### Notes to Callers

Your container application can call **IOleLink::GetSourceDisplayName** to display the current source of a link.

The current source of a link is displayed in the **Links** dialog box. If you use the [OleUIEditLinks](https://learn.microsoft.com/windows/desktop/api/oledlg/nf-oledlg-oleuieditlinksa) function to display the **Links** dialog box, you must implement the [IOleUILinkContainer](https://learn.microsoft.com/windows/desktop/api/oledlg/nn-oledlg-ioleuilinkcontainera) interface. The dialog box calls your implementations of [IOleUILinkContainer::GetLinkSource](https://learn.microsoft.com/windows/desktop/api/oledlg/nf-oledlg-ioleuilinkcontainera-getlinksource) to get the string it should display. Your implementation of that method can call **IOleLink::GetSourceDisplayName**.

### Notes to Implementers

The linked object's implementation of **IOleLink::GetSourceDisplayName** calls [IOleLink::GetSourceMoniker](https://learn.microsoft.com/windows/desktop/api/oleidl/nf-oleidl-iolelink-getsourcemoniker) to get the link source moniker, and then calls [IMoniker::GetDisplayName](https://learn.microsoft.com/windows/desktop/api/objidl/nf-objidl-imoniker-getdisplayname) to get that moniker's display name. This operation is potentially expensive because it might require binding the moniker. All of the system-provided monikers can return a display name without binding, but there is no guarantee that other moniker implementations can. Instead of making repeated calls to **IOleLink::GetSourceDisplayName**, your container application can cache the name and update it whenever the link source is bound.

## See also

[IMoniker::GetDisplayName](https://learn.microsoft.com/windows/desktop/api/objidl/nf-objidl-imoniker-getdisplayname)

[IOleLink](https://learn.microsoft.com/windows/desktop/api/oleidl/nn-oleidl-iolelink)

[IOleLink::SetSourceDisplayName](https://learn.microsoft.com/windows/desktop/api/oleidl/nf-oleidl-iolelink-setsourcedisplayname)

[IOleUILinkContainer](https://learn.microsoft.com/windows/desktop/api/oledlg/nn-oledlg-ioleuilinkcontainera)

[OleUIEditLinks](https://learn.microsoft.com/windows/desktop/api/oledlg/nf-oledlg-oleuieditlinksa)