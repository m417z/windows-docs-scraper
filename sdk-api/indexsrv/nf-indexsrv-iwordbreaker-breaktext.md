# IWordBreaker::BreakText

## Description

Parses text to identify words and phrases and provides the results to the [IWordSink](https://learn.microsoft.com/windows/desktop/search/iwordsink) and [IPhraseSink](https://learn.microsoft.com/windows/desktop/api/indexsrv/nn-indexsrv-iphrasesink) objects.

## Parameters

### `pTextSource` [in]

Type: **[TEXT_SOURCE](https://learn.microsoft.com/windows/desktop/api/indexsrv/ns-indexsrv-text_source)***

Pointer to a [TEXT_SOURCE](https://learn.microsoft.com/windows/desktop/api/indexsrv/ns-indexsrv-text_source) structure that contains Unicode text.

### `pWordSink` [in]

Type: **IWordSink***

Pointer to the [IWordSink](https://learn.microsoft.com/windows/desktop/search/iwordsink) object that receives and handles words generated by this method. **NULL** indicates that this method should identify phrases only.

### `pPhraseSink` [in]

Type: **IPhraseSink***

Pointer to the [IPhraseSink](https://learn.microsoft.com/windows/desktop/api/indexsrv/nn-indexsrv-iphrasesink) object that receives and handles phrases generated by this method. **NULL** indicates that this method should identify individual words, not phrases.

## Return value

Type: **HRESULT**

This method can return one of these values.

| Return code | Description |
| --- | --- |
| **S_OK** | Operation was successful. No more text is available to refill the *pTextSource* buffer. |
| **E_INVALIDARG** | Invalid argument. The *pTextSource* parameter is **NULL**. |

## Remarks

Because word breakers more commonly parse for words than phrases, you should optimize for *pPhraseSink* = 0. Either *pWordSink* or *pPhraseSink* can be **NULL**, but not both.

The [IWordSink](https://learn.microsoft.com/windows/desktop/search/iwordsink) object holds the words and their alternative forms for the word breaker. Alternative forms of words, if they exist, are put in the **IWordSink** object first, by using the **WordSink::PutAltWord** method, and the root word is added last, by using the **WordSink::PutWord** method.

Use **pfnFillTextBuffer**, the function pointer element in the [TEXT_SOURCE](https://learn.microsoft.com/windows/desktop/api/indexsrv/ns-indexsrv-text_source) structure, to replenish the source text. The **IWordBreaker::BreakText** method must handle all **pfnFillTextBuffer** return values. If an error occurs, finish processing the text in the buffer before handling the error.

## See also

[IWordBreaker](https://learn.microsoft.com/windows/desktop/api/indexsrv/nn-indexsrv-iwordbreaker)

[TEXT_SOURCE](https://learn.microsoft.com/windows/desktop/api/indexsrv/ns-indexsrv-text_source)