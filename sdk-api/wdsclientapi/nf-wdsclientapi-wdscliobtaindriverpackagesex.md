# WdsCliObtainDriverPackagesEx function

## Description

This function obtains the driver packages (INF files) that are applicable to the specified WDS driver query XML. The [WdsCliFreeStringArray](https://learn.microsoft.com/windows/desktop/api/wdsclientapi/nf-wdsclientapi-wdsclifreestringarray) function can be used to free the array of string values allocated by this function. The [WdsCliGetDriverQueryXml](https://learn.microsoft.com/windows/desktop/api/wdsclientapi/nf-wdsclientapi-wdscligetdriverqueryxml) function can be used to generate the required driver query XML string.

## Parameters

### `hSession` [in]

A handle to a session with the WDS server. This handle is returned by the [WdsCliCreateSession](https://learn.microsoft.com/windows/desktop/api/wdsclientapi/nf-wdsclientapi-wdsclicreatesession) function.

### `pwszMachineInfo` [out]

A pointer to a string containing WDS driver query XML which can be generated by calling the [WdsCliGetDriverQueryXml](https://learn.microsoft.com/windows/desktop/api/wdsclientapi/nf-wdsclientapi-wdscligetdriverqueryxml) function.

### `ppwszServerName` [out]

A pointer to a pointer to a string value that receives the IP address of the server hosting the driver packages.

### `pppwszDriverPackages` [out]

An array of string values that are the full paths for the driver packages (INF files.) The Internet Protocol (IP) address, rather than a computer name, is returned as part of the path. For example, a string value **\\172.31.224.245\REMINST\Stores\Drivers\driver.inf** in the array gives the full path to driver.inf.

### `pulCount` [out]

The number of driver packages returned by pppwszDriverPackages.

## Return value

If the function succeeds, the return is **S_OK**.