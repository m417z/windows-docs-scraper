# IAntimalware::Scan

## Description

Scan a stream of content.

## Parameters

### `stream` [in]

The [IAmsiStream](https://learn.microsoft.com/windows/desktop/api/amsi/nn-amsi-iamsistream) stream to be scanned.

### `result` [out]

The result of the scan. See [AMSI_RESULT](https://learn.microsoft.com/windows/desktop/api/amsi/ne-amsi-amsi_result).

### `provider` [out]

The [IAntimalwareProvider](https://learn.microsoft.com/windows/desktop/api/amsi/nn-amsi-iantimalwareprovider) provider of the antimalware product.

## Return value

This method can return one of these values.

| Return code | Description |
| --- | --- |
| **S_OK** | Success. |
| **E_INVALIDARG** | One or more argument is invalid. |
| **E_NOT_VALID_STATE** | The object is not initialized. |

## See also

[AMSI_RESULT](https://learn.microsoft.com/windows/desktop/api/amsi/ne-amsi-amsi_result)

[IAmsiStream](https://learn.microsoft.com/windows/desktop/api/amsi/nn-amsi-iamsistream)

[IAntimalware](https://learn.microsoft.com/windows/desktop/api/amsi/nn-amsi-iantimalware)

[IAntimalwareProvider](https://learn.microsoft.com/windows/desktop/api/amsi/nn-amsi-iantimalwareprovider)