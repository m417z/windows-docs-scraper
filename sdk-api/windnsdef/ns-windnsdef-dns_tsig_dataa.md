# DNS_TSIG_DATAA structure

## Description

The
**DNS_TSIG_DATA** structure represents a secret key transaction authentication (TSIG) resource record (RR) as specified in [RFC 2845](https://www.ietf.org/rfc/rfc2845.txt) and [RFC 3645](https://www.ietf.org/rfc/rfc3645.txt).

## Members

### `pNameAlgorithm`

A pointer to a string that represents the name of the key used to generate **pSignature** as defined in section 2.3 of [RFC 2845](https://www.ietf.org/rfc/rfc2845.txt).

### `pAlgorithmPacket`

A pointer to a string that represents the name of the algorithm used to generate **pSignature** as defined in section 2.3 of [RFC 2845](https://www.ietf.org/rfc/rfc2845.txt).

| Value | Meaning |
| --- | --- |
| **"gss.microsoft.com"** | Windows 2000 Server only: Generic Security Service Algorithm for Secret Key Transaction Authentication for DNS (GSS-API) as defined in [RFC 3645](https://www.ietf.org/rfc/rfc3645.txt). |
| **"gss-tsig"** | Generic Security Service Algorithm for Secret Key Transaction Authentication for DNS (GSS-API) as defined in [RFC 3645](https://www.ietf.org/rfc/rfc3645.txt). |

### `pSignature`

A pointer to the Message
Authentication Code (MAC) generated by the algorithm in **pAlgorithmPacket**. The length, in bytes, and composition of **pSignature** are determined by **pAlgorithmPacket**.

### `pOtherData`

If **wError** contains the RCODE, **BADTIME**, **pOtherData** is a BYTE array that contains the server's current time, otherwise it is **NULL**. Time is expressed in seconds since the beginning of January 1, 1970, Greenwich Mean Time (GMT), excluding leap seconds.

### `i64CreateTime`

The time **pSignature** was generated, expressed in seconds since the beginning of January 1, 1970, Greenwich Mean Time (GMT), excluding leap seconds.

### `wFudgeTime`

The time, in seconds, **i64CreateTime** may be in error.

### `wOriginalXid`

The [Xid](https://learn.microsoft.com/windows/win32/api/windnsdef/ns-windnsdef-dns_header) identifier of the original message.

### `wError`

An error, expressed in expanded RCODE format that covers TSIG and TKEY RR processing.

| Value | Meaning |
| --- | --- |
| **DNS_RCODE_BADSIG** | The **pSignature** field is bad. |
| **DNS_RCODE_BADKEY** | The **pKey** field of the [DNS_TKEY_DATA](https://learn.microsoft.com/windows/win32/api/windnsdef/ns-windnsdef-dns_tkey_dataw) RR is bad. |
| **DNS_RCODE_BADTIME** | A timestamp is bad. |

### `wSigLength`

The length, in bytes, of the **pSignature** member.

### `wOtherLength`

The length, in bytes, of the **pOtherData** member.

### `cAlgNameLength`

The length, in bytes, of the **pAlgorithmPacket** member.

### `bPacketPointers`

Reserved for future use. Do not use.

## Remarks

The
**DNS_TSIG_DATA** structure is used in conjunction with the
[DNS_RECORD](https://learn.microsoft.com/windows/win32/api/windnsdef/ns-windnsdef-dns_recorda) structure to programmatically manage DNS entries.

> [!NOTE]
> The windns.h header defines DNS_TSIG_DATA as an alias that automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that is not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see [Conventions for Function Prototypes](https://learn.microsoft.com/windows/win32/intl/conventions-for-function-prototypes).

## See also

[DNS_RECORD](https://learn.microsoft.com/windows/win32/api/windnsdef/ns-windnsdef-dns_recorda)

[DNS_TKEY_DATA](https://learn.microsoft.com/windows/win32/api/windnsdef/ns-windnsdef-dns_tkey_dataw)