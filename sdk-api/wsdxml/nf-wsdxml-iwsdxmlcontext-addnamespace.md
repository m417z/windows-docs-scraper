# IWSDXMLContext::AddNamespace

## Description

Creates an object that represents a namespace in an XML context. If the namespace already exists, no new namespace will be added, and the namespace object for the existing name will be returned.

## Parameters

### `pszUri` [in]

The URI of the namespace.

### `pszSuggestedPrefix` [in]

The namespace prefix to use when generating XML. If the namespace already exists, *pszSuggestedPrefix* will overwrite the prefix currently associated with the namespace. The XML context may assign a different namespace prefix. The prefix assigned by the XML context takes precedence over the suggested prefix. The **PreferredPrefix** member of the structure pointed to by *ppNamespace* contains the prefix assigned by the XML context.

### `ppNamespace` [out]

Pointer to the address of the [WSDXML_NAMESPACE](https://learn.microsoft.com/windows/desktop/api/wsdxmldom/ns-wsdxmldom-wsdxml_namespace) structure that represents the namespace. You must deallocate *ppNamespace* by calling [WSDFreeLinkedMemory](https://learn.microsoft.com/windows/desktop/api/wsdutil/nf-wsdutil-wsdfreelinkedmemory). This parameter is optional.

## Return value

Possible return values include, but are not limited to, the following.

| Return code | Description |
| --- | --- |
| **S_OK** | The method succeeded. |
| **E_INVALIDARG** | *pszUri* is **NULL**, the length in characters of the URI string exceeds WSD_MAX_TEXT_LENGTH (8192), *pszSuggestedPrefix* is **NULL**, or the length in characters of the prefix string exceeds WSD_MAX_TEXT_LENGTH (8192). |
| **E_OUTOFMEMORY** | Insufficient memory to complete the operation. |
| **E_FAIL** | The method failed. |

## Remarks

The returned [WSDXML_NAMESPACE](https://learn.microsoft.com/windows/desktop/api/wsdxmldom/ns-wsdxmldom-wsdxml_namespace) structure can be used to force an association between the namespace prefix (as specified by *pszSuggestedPrefix*) and the namespace URI (as specified by *pszUri*). Once this association is established, the XML generator will produce XML with the specified namespace prefix.

You can call **AddNamespace** to retrieve the [WSDXML_NAMESPACE](https://learn.microsoft.com/windows/desktop/api/wsdxmldom/ns-wsdxmldom-wsdxml_namespace) structure created when a namespace was automatically generated by a call to [AddNameToNamespace](https://learn.microsoft.com/windows/desktop/api/wsdxml/nf-wsdxml-iwsdxmlcontext-addnametonamespace).

## See also

[IWSDXMLContext](https://learn.microsoft.com/windows/desktop/api/wsdxml/nn-wsdxml-iwsdxmlcontext)