## Description

> [!IMPORTANT]
> Some information relates to a prerelease product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.

The **WlanRegisterNotification** function is used to register and unregister notifications on all wireless interfaces.

## Parameters

### `hClientHandle` [in]

The client's session handle, obtained by a previous call to the [WlanOpenHandle](https://learn.microsoft.com/windows/desktop/api/wlanapi/nf-wlanapi-wlanopenhandle) function.

### `dwNotifSource` [in]

The notification sources to be registered. These flags may be combined. When this parameter is set to **WLAN_NOTIFICATION_SOURCE_NONE**, **WlanRegisterNotification** unregisters notifications on all wireless interfaces.

The possible values for this parameter are defined in the *Wlanapi.h* and *L2cmn.h* header files.

The following table shows possible values.

| Value | Meaning |
| --- | --- |
| **WLAN_NOTIFICATION_SOURCE_NONE** | Unregisters notifications. |
| **WLAN_NOTIFICATION_SOURCE_ALL** | Registers for all notifications available on the version of the operating system, including those generated by the 802.1X module. <br><br>For Windows XP with SP3 and Wireless LAN API for Windows XP with SP2, setting *dwNotifSource* to **WLAN_NOTIFICATION_SOURCE_ALL** is functionally equivalent to setting *dwNotifSource* to **WLAN_NOTIFICATION_SOURCE_ACM**. |
| **WLAN_NOTIFICATION_SOURCE_ACM** | Registers for notifications generated by the auto configuration module.<br><br>**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** Only the wlan_notification_acm_connection_complete and wlan_notification_acm_disconnected notifications are available. |
| **WLAN_NOTIFICATION_SOURCE_HNWK** | Registers for notifications generated by the wireless Hosted Network. This notification source is available on Windows 7 and on Windows Server 2008 R2 with the Wireless LAN Service installed. |
| **WLAN_NOTIFICATION_SOURCE_ONEX** | Registers for notifications generated by 802.1X. |
| **WLAN_NOTIFICATION_SOURCE_MSM** | Registers for notifications generated by MSM.<br><br>If the **WLAN_NOTIFICATION_SOURCE_MSM** flag is set in *dwNotifSource*, then the **wiFiControl** device capability is required (see [App capability declarations](https://learn.microsoft.com/windows/uwp/packaging/app-capability-declarations)). If that capability is not granted, then the function returns **ERROR_ACCESS_DENIED**. Requesting the **wiFiControl** device capability will require consent from the user regarding access to location. For more info, see [Changes to API behavior for Wi-Fi access and location](https://learn.microsoft.com/windows/win32/nativewifi/wi-fi-access-location-changes).<br><br>**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** This value is not supported. |
| **WLAN_NOTIFICATION_SOURCE_SECURITY** | Registers for notifications generated by the security module.<br><br>No notifications are currently defined for **WLAN_NOTIFICATION_SOURCE_SECURITY**.<br><br>**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** This value is not supported. |
| **WLAN_NOTIFICATION_SOURCE_IHV** | Registers for notifications generated by independent hardware vendors (IHV).<br><br>**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** This value is not supported. |
| **WLAN_NOTIFICATION_SOURCE_DEVICE_SERVICE** | Registers for notifications generated by device services. |

**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** This parameter must be set to WLAN_NOTIFICATION_SOURCE_NONE, WLAN_NOTIFICATION_SOURCE_ALL, or WLAN_NOTIFICATION_SOURCE_ACM.

### `bIgnoreDuplicate` [in]

Specifies whether duplicate notifications will be ignored. If set to **TRUE**, a notification will not be sent to the client if it is identical to the previous one.

**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** This parameter is ignored.

### `funcCallback` [in, optional]

A [WLAN_NOTIFICATION_CALLBACK](https://learn.microsoft.com/windows/desktop/api/wlanapi/nc-wlanapi-wlan_notification_callback) type that defines the type of notification callback function.

This parameter can be **NULL** if the *dwNotifSource* parameter is set to **WLAN_NOTIFICATION_SOURCE_NONE** to unregister notifications on all wireless interfaces,

### `pCallbackContext` [in, optional]

A pointer to the client context that will be passed to the callback function with the notification.

### `pReserved` [in]

Reserved for future use. Must be set to **NULL**.

### `pdwPrevNotifSource` [out, optional]

A pointer to the previously registered notification sources.

## Return value

If the function succeeds, the return value is ERROR_SUCCESS.

If the function fails, the return value may be one of the following return codes.

If the **WLAN_NOTIFICATION_SOURCE_MSM** flag is set in *dwNotifSource*, then the **wiFiControl** device capability is required (see [App capability declarations](https://learn.microsoft.com/windows/uwp/packaging/app-capability-declarations)). If that capability is not granted, then the function returns **ERROR_ACCESS_DENIED**. Requesting the **wiFiControl** device capability will require consent from the user regarding access to location. For more info, see [Changes to API behavior for Wi-Fi access and location](https://learn.microsoft.com/windows/win32/nativewifi/wi-fi-access-location-changes).

| Return code | Description |
| --- | --- |
| **ERROR_INVALID_PARAMETER** | A parameter is incorrect. This error is returned if *hClientHandle* is **NULL** or not valid or if *pReserved* is not **NULL**. |
| **ERROR_INVALID_HANDLE** | The handle *hClientHandle* was not found in the handle table. |
| **ERROR_NOT_ENOUGH_MEMORY** | Failed to allocate memory for the query results. |
| **ERROR_ACCESS_DENIED** | If the **WLAN_NOTIFICATION_SOURCE_MSM** flag is set in *dwNotifSource*, then the **wiFiControl** device capability is required (see [App capability declarations](https://learn.microsoft.com/windows/uwp/packaging/app-capability-declarations). If that capability is not granted, then the function returns **ERROR_ACCESS_DENIED**. Requesting the **wiFiControl** device capability will require consent from the user regarding access to location. For more info, see [Changes to API behavior for Wi-Fi access and location](https://learn.microsoft.com/windows/win32/nativewifi/wi-fi-access-location-changes). |
| **RPC_STATUS** | Various error codes. |

## Remarks

The **WlanRegisterNotification** is used by an application to register and unregister notifications on all wireless interfaces. When registering for notifications, an application must provide a callback function pointed to by the *funcCallback* parameter. The prototype for this callback function is the [WLAN_NOTIFICATION_CALLBACK](https://learn.microsoft.com/windows/desktop/api/wlanapi/nc-wlanapi-wlan_notification_callback). This callback function will receive notifications that have been registered for in the *dwNotifSource* parameter passed to the **WlanRegisterNotification** function. The callback function is called with a pointer to a [WLAN_NOTIFICATION_DATA](https://learn.microsoft.com/previous-versions/windows/desktop/legacy/ms706902(v=vs.85)) structure as the first parameter that contains detailed information on the notification. The callback function also receives a second parameter that contains a pointer to the client context passed in the *pCallbackContext* parameter to the **WlanRegisterNotification** function.

The **WlanRegisterNotification** function will return an error if *dwNotifSource* is a value other than **WLAN_NOTIFICATION_SOURCE_NONE** and the client fails to provide a callback function.

Once registered, the callback function will be called whenever a notification is available until the client unregisters or closes the handle.

Any registration to receive notifications caused by this function would be automatically undone if the calling application closes its calling handle (by calling [WlanCloseHandle](https://learn.microsoft.com/windows/desktop/api/wlanapi/nf-wlanapi-wlanclosehandle) with the *hClientHandle* parameter) or if the process ends.

Don't call **WlanRegisterNotification** from a callback function. If the client is in the middle of a notification callback when **WlanRegisterNotification** is called with *dwNotifSource* set to **WLAN_NOTIFICATION_SOURCE_NONE** (that is, when the client is unregistering from notifications), then **WlanRegisterNotification** will wait for the callback to finish before returning a value. Calling this function inside a callback function will result in the call never completing. If both the callback function and the thread that unregisters from notifications try to acquire the same lock, a deadlock may occur. In addition, don't call **WlanRegisterNotification** from the **DllMain** function in an application DLL. This could also cause a deadlock.

An application can time out and query the current interface state instead of waiting for a notification.

**Windows XP with SP3 and Wireless LAN API for Windows XP with SP2:** Notifications are handled by the Netman service. If the Netman service is disabled or unavailable, notifications will not be received. If a notification is not received within a reasonable period of time, an application should time out and query the current interface state.

## See also

[ONEX_NOTIFICATION_TYPE](https://learn.microsoft.com/windows/desktop/api/dot1x/ne-dot1x-onex_notification_type)

[WLAN_HOSTED_NETWORK_NOTIFICATION_CODE](https://learn.microsoft.com/windows/win32/api/wlanapi/ne-wlanapi-wlan_hosted_network_notification_code)

[WLAN_NOTIFICATION_ACM](https://learn.microsoft.com/windows/win32/api/wlanapi/ne-wlanapi-wlan_notification_acm-r1)

[WLAN_NOTIFICATION_CALLBACK](https://learn.microsoft.com/windows/desktop/api/wlanapi/nc-wlanapi-wlan_notification_callback)

[WLAN_NOTIFICATION_DATA](https://learn.microsoft.com/previous-versions/windows/desktop/legacy/ms706902(v=vs.85))

[WLAN_NOTIFICATION_MSM](https://learn.microsoft.com/windows/win32/api/wlanapi/ne-wlanapi-wlan_notification_msm-r1)

[WlanCloseHandle](https://learn.microsoft.com/windows/desktop/api/wlanapi/nf-wlanapi-wlanclosehandle)

[WlanRegisterVirtualStationNotification](https://learn.microsoft.com/windows/desktop/api/wlanapi/nf-wlanapi-wlanregistervirtualstationnotification)