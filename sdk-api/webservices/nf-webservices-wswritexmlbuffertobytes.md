# WsWriteXmlBufferToBytes function

## Description

Uses a writer to convert a [WS_XML_BUFFER](https://learn.microsoft.com/windows/desktop/wsw/ws-xml-buffer) to an encoded set of bytes.

## Parameters

### `writer` [in]

The writer to use to generate the encoded bytes.

### `xmlBuffer` [in]

The XML buffer to write.

### `encoding` [in, optional]

The encoding to use when generating the bytes. If **NULL**, the bytes will be encoded in utf8.

### `properties`

An array of optional properties of the writer. See [WS_XML_WRITER_PROPERTY](https://learn.microsoft.com/windows/desktop/api/webservices/ns-webservices-ws_xml_writer_property).

### `propertyCount` [in]

The number of properties.

### `heap` [in]

The heap from which to allocate the bytes.

### `bytes`

The generated bytes are returned here.

### `byteCount` [out]

The number of generated bytes are returned here.

### `error` [in, optional]

Specifies where additional error information should be stored if the function fails.

## Return value

This function can return one of these values.

| Return code | Description |
| --- | --- |
| **E_INVALIDARG** | One or more arguments are invalid. |
| **WS_E_INVALID_OPERATION** | The operation is not allowed due to the current state of the object. |
| **WS_E_QUOTA_EXCEEDED** | A quota was exceeded. |

## Remarks

The function will generate the entire contents of the [WS_XML_BUFFER](https://learn.microsoft.com/windows/desktop/wsw/ws-xml-buffer) as a linear set of bytes
allocated from the specified heap in the encoding specified.

The writer will be left in an undefined state after calling this function. However, **WsWriteXmlBufferToBytes**
may be used again with such a writer. Otherwise, [WsSetOutput](https://learn.microsoft.com/windows/desktop/api/webservices/nf-webservices-wssetoutput) or [WsSetOutputToBuffer](https://learn.microsoft.com/windows/desktop/api/webservices/nf-webservices-wssetoutputtobuffer) should be
used to bring the writer back to a known state, or the writer should be freed using [WsFreeWriter](https://learn.microsoft.com/windows/desktop/api/webservices/nf-webservices-wsfreewriter).