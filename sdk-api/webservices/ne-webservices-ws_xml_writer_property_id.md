## Description

Each xml writer property is identified by an ID and has an associated value.
This enumeration is used within the [WS_XML_WRITER_PROPERTY](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_property) structure, which is used as a parameter to [WsCreateWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wscreatewriter), [WsSetOutput](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutput), [WsSetOutputToBuffer](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutputtobuffer), and [WsWriteXmlBufferToBytes](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wswritexmlbuffertobytes). It is also used directly as a parameter to [WsGetWriterProperty](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsgetwriterproperty).

## Constants

### `WS_XML_WRITER_PROPERTY_MAX_DEPTH:0`

A **ULONG** that specifies the maximum depth of the document that the writer will permit.

Depth is measured at any point by the number of nested start elements.

A depth of 0 prevents any start elements from being written.

This property defaults to 32.

### `WS_XML_WRITER_PROPERTY_ALLOW_FRAGMENT:1`

A [WS_XML_WRITER_MTOM_ENCODING](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_mtom_encoding) structure that specifies whether the writer will permit multiple elements and non-white space at the top level of the document. This property
may not be set to **TRUE** with **WS_XML_WRITER_MTOM_ENCODING**.

This property defaults to **FALSE**.

### `WS_XML_WRITER_PROPERTY_MAX_ATTRIBUTES:2`

A **ULONG** that specifies
the maximum number of attributes the writer will permit on an element.

This property defaults to 128.

### `WS_XML_WRITER_PROPERTY_WRITE_DECLARATION:3`

A **BOOL** that specifies if the writer should emit an appropriate xml declaration at the start of the document.

This property defaults to **FALSE**.

### `WS_XML_WRITER_PROPERTY_INDENT:4`

A **ULONG** that specifies the how many spaces of indenting should be used to format the xml. If indent is zero, no formatting occurs.

This property defaults to 0.

### `WS_XML_WRITER_PROPERTY_BUFFER_TRIM_SIZE:5`

A **ULONG** that specifies one of the following.

If the writer is using [WS_XML_WRITER_BUFFER_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_buffer_output), then this property is the maximum number of bytes
the writer will retain across calls to [WsSetOutput](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutput) for purposes of buffering output.

If the writer is using [WS_XML_WRITER_STREAM_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_stream_output), then this property is the maximum number of bytes
the writer will retain across calls to [WsSetOutput](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutput) and [WsFlushWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsflushwriter) for
purposes of buffering output.

This property has no effect when specified with [WsSetOutputToBuffer](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutputtobuffer).

This property defaults to 4096.

### `WS_XML_WRITER_PROPERTY_CHARSET:6`

A [WS_CHARSET](https://learn.microsoft.com/windows/win32/api/webservices/ne-webservices-ws_charset) value that
returns the character set the writer is using to encode the document. This value is only available for
text documents.

### `WS_XML_WRITER_PROPERTY_BUFFERS:7`

A [WS_BUFFERS](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_buffers) structure
that returns a set of buffers containing the generated xml bytes.

If the writer is using [WS_XML_WRITER_BUFFER_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_buffer_output), then the all the generated bytes are returned, and
the buffers are valid until [WsSetOutput](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutput) or [WsFreeWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsfreewriter) is called.

If the writer is using [WS_XML_WRITER_MTOM_ENCODING](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_mtom_encoding), then there must be no open elements.
The supporting MIME parts will be generated and included in the returned buffers. Once this
occurs, any API that attempts to write further to the xml document will return **WS_E_INVALID_OPERATION**.
(See [Windows Web Services Return Values](https://learn.microsoft.com/windows/desktop/wsw/windows-web-services-return-values).)

This property is not available when using [WS_XML_WRITER_STREAM_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_stream_output).

This property is not available on a writer that is set to a [WS_XML_BUFFER](https://learn.microsoft.com/windows/desktop/wsw/ws-xml-buffer).

This may be less convenient but more efficient than using [WS_XML_WRITER_PROPERTY_BYTES](https://learn.microsoft.com/windows/win32/api/webservices/ne-webservices-ws_xml_writer_property_id) because the
writer does not have to concatenate the buffers that comprise the document into a single buffer.

### `WS_XML_WRITER_PROPERTY_BUFFER_MAX_SIZE:8`

A **ULONG** that
specifies the maximum number of bytes the writer will buffer.

If the writer is using [WS_XML_WRITER_BUFFER_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_buffer_output), then this is the maximum number of
bytes that will buffered for the entire document. Calls to [WsFlushWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsflushwriter) have no effect.

If the writer is using [WS_XML_WRITER_STREAM_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_stream_output), then this is the maxmimum amount of
data that will be buffered between [WsFlushWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsflushwriter) calls.

This property has no effect when specified with [WsSetOutputToBuffer](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutputtobuffer).

### `WS_XML_WRITER_PROPERTY_BYTES:9`

A [WS_BUFFERS](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_buffers) structure
that returns a single buffer containing the generated xml bytes.

If the writer is using [WS_XML_WRITER_BUFFER_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_buffer_output), then all the generated bytes are returned, and
the buffer is valid until [WsSetOutput](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutput) or [WsFreeWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsfreewriter) is called.

If the writer is using [WS_XML_WRITER_MTOM_ENCODING](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_mtom_encoding), then there must be no open elements.
The supporting MIME parts will be generated and included in the returned buffers. Once this
occurs, any API that attempts to write further to the xml document will return **WS_E_INVALID_OPERATION**.

This property is not available when using [WS_XML_WRITER_STREAM_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_stream_output).

This property is not available on a writer that is set to a [WS_XML_BUFFER](https://learn.microsoft.com/windows/desktop/wsw/ws-xml-buffer).

This may be more convenient but less efficient than using [WS_XML_WRITER_PROPERTY_BUFFERS](https://learn.microsoft.com/windows/win32/api/webservices/ne-webservices-ws_xml_writer_property_id) because the
writer may need to concatenate the buffers that comprise the document into a single buffer.

### `WS_XML_WRITER_PROPERTY_IN_ATTRIBUTE:10`

A **BOOL** that
indicates that [WsWriteStartAttribute](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wswritestartattribute) has been called and the writer is
positioned on attribute content.

### `WS_XML_WRITER_PROPERTY_MAX_MIME_PARTS_BUFFER_SIZE:11`

A **ULONG** used with [WS_XML_WRITER_MTOM_ENCODING](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_mtom_encoding). This specifies the maximum amount of data that
will be buffered for purposes of writing the MIME parts. [WsWriteBytes](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wswritebytes) and
[WsPullBytes](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wspullbytes) need to buffer data in order to emit the data as a separate MIME part that
follows the document, and this can be used to limit how much is buffered.

This property defaults to 65536.

### `WS_XML_WRITER_PROPERTY_INITIAL_BUFFER:12`

A [WS_BYTES](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_bytes) structure that contains a buffer that the writer may use for encoding the xml document. This is
useful when an upper bound on the size of the generated xml data is known, or the caller wants to own
the buffer in which the bytes are placed.

If the size specified is greater than or equal to [WS_XML_WRITER_PROPERTY_BUFFER_MAX_SIZE](https://learn.microsoft.com/windows/win32/api/webservices/ne-webservices-ws_xml_writer_property_id), then the
writer will not allocate from its internal buffers.

This buffer may appear as one of the buffers returned by the property [WS_XML_WRITER_PROPERTY_BUFFERS](https://learn.microsoft.com/windows/win32/api/webservices/ne-webservices-ws_xml_writer_property_id) or **WS_XML_WRITER_PROPERTY_BYTES**.

The caller must ensure that the buffer specified is valid for the lifetime of the writer.

### `WS_XML_WRITER_PROPERTY_ALLOW_INVALID_CHARACTER_REFERENCES:13`

A **BOOL** used with [WS_XML_WRITER_TEXT_ENCODING](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_text_encoding). Setting this to **TRUE** permits character references
of characters considered invalid by XML 1.0 to be accepted.

Setting this property to **TRUE** may affect interoperability.

This property defaults to **FALSE**.

### `WS_XML_WRITER_PROPERTY_MAX_NAMESPACES:14`

A **ULONG** that specifies the maximum number of xmlns unique declarations that may appear in scope at any point
while writing the document.

This property defaults to 32.

### `WS_XML_WRITER_PROPERTY_BYTES_WRITTEN:15`

A **ULONG** that specifies one of the following.

If the writer is using [WS_XML_WRITER_BUFFER_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_buffer_output), then this property
returns the number of bytes that have been written to the writer.

If the writer is using [WS_XML_WRITER_STREAM_OUTPUT](https://learn.microsoft.com/windows/win32/api/webservices/ns-webservices-ws_xml_writer_stream_output), then this property
returns the number of bytes that have been written to the writer since the last call to
[WsFlushWriter](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wsflushwriter).

If the writer is currently writing an element start tag, then the size of the start tag is not included in
the value returned.

This property is not available on a writer that was set using [WsSetOutputToBuffer](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutputtobuffer).

### `WS_XML_WRITER_PROPERTY_BYTES_TO_CLOSE:16`

A **ULONG** that returns the maximum number of bytes necessary to close any open elements.

An application can use [WS_XML_WRITER_PROPERTY_BYTES_WRITTEN](https://learn.microsoft.com/windows/win32/api/webservices/ne-webservices-ws_xml_writer_property_id) and
**WS_XML_WRITER_PROPERTY_BYTES_TO_CLOSE** to approximate how much additional
data may be written to the document. When doing so, the application should take into account
the encoding of the document being written.

This property is not available on a writer that was set using [WsSetOutputToBuffer](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wssetoutputtobuffer).

### `WS_XML_WRITER_PROPERTY_COMPRESS_EMPTY_ELEMENTS:17`

A **BOOL** that controls how [WsCopyNode](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wscopynode) copies elements with no content.

When this property is set to **FALSE**, [WsCopyNode](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wscopynode) preserves whether each element is represented
as a start/end tag pair, or as an empty element. When this property is set to **TRUE**, **WsCopyNode** will
convert elements with no content to empty elements.

The binary encoding does not support empty elements. When using [WsCopyNode](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wscopynode) with
a writer using the binary encoding this property has no effect either way. All empty elements are
converted into elements with no content.

By default, this property is **FALSE**.

For an input XML string like:

```
<?xml version="1.0" encoding="utf-8"?>
<container>
 <emptyElement />
 <emptyElementWithEndTag></emptyElementWithEndTag>
</container>
```

If this property is **FALSE**, [WsCopyNode](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wscopynode) will generate the following xml:

```
<?xml version="1.0" encoding="utf-8"?>
<container>
 <emptyElement />
 <emptyElementWithEndTag></emptyElementWithEndTag>
</container>
```

If this property is **TRUE**, [WsCopyNode](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wscopynode) will generate the following xml:

```
<?xml version="1.0" encoding="utf-8"?>
<container>
 <emptyElement />
 <emptyElementWithEndTag />
</container>
```

### `WS_XML_WRITER_PROPERTY_EMIT_UNCOMPRESSED_EMPTY_ELEMENTS:18`

Windows 8 or later: A **BOOL** that controls how empty elements are emitted.

If set to **FALSE**, an element that is created by only calls to [WsWriteStartElement](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wswritestartelement) and [WsWriteEndElement](https://learn.microsoft.com/windows/win32/api/webservices/nf-webservices-wswriteendelement) will be emitted as follows:

```
<emptyElement />
```

If set to **TRUE**, that element will be emitted as follows:

xml
\<emptyElement>\</emptyElement>

The default is **FALSE**