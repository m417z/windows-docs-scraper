# SHQueryUserNotificationState function

## Description

Checks the state of the computer for the current user to determine whether sending a notification is appropriate.

## Parameters

### `pquns` [out]

Type: **[QUERY_USER_NOTIFICATION_STATE](https://learn.microsoft.com/windows/desktop/api/shellapi/ne-shellapi-query_user_notification_state)***

When this function returns, contains a pointer to one of the values of the [QUERY_USER_NOTIFICATION_STATE](https://learn.microsoft.com/windows/desktop/api/shellapi/ne-shellapi-query_user_notification_state) enumeration.

## Return value

Type: **HRESULT**

If this function succeeds, it returns **S_OK**. Otherwise, it returns an **HRESULT** error code.

## Remarks

Applications should call **SHQueryUserNotificationState** and test the return value before displaying any notification UI that is similar to the balloon notifications generated by [Shell_NotifyIcon](https://learn.microsoft.com/windows/desktop/api/shellapi/nf-shellapi-shell_notifyicona). Notifications should only be displayed if this API returns [QNS_ACCEPTS_NOTIFICATIONS](https://learn.microsoft.com/windows/desktop/api/shellapi/ne-shellapi-query_user_notification_state). This informs the application whether the user is running processes that should not be interrupted. Top-level windows receive a [WM_SETTINGCHANGE](https://learn.microsoft.com/windows/desktop/winmsg/wm-settingchange) message when the user turns presentation settings on or off, and also when the user's session is locked or unlocked. Note that there are no notifications sent when the user starts or stops a full-screen application.

If this function returns [QUNS_QUIET_TIME](https://learn.microsoft.com/windows/desktop/api/shellapi/ne-shellapi-query_user_notification_state), notifications should be displayed only if critical.