typedef struct DIDEVICESTATE {
  DWORD dwSize;
  DWORD dwState;
  DWORD dwLoad;
} DIDEVICESTATE, *LPDIDEVICESTATE;