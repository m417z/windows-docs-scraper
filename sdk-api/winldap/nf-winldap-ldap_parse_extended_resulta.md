# ldap_parse_extended_resultA function

## Description

The **ldap_parse_extended_result** parses the results of an LDAP extended operation.

## Parameters

### `Connection` [in]

The session handle.

### `ResultMessage` [in]

A pointer to an
[LDAPMessage](https://learn.microsoft.com/windows/desktop/api/winldap/ns-winldap-ldapmessage) structure as returned by
[ldap_result](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) in response to an extended operation request.

### `ResultOID` [out]

A pointer to a null-terminated string that contains the dotted object identifier (OID) text string of the server's response message. This is normally the same OID as the one naming the request that was originally passed to the server by
[ldap_extended_operation](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_extended_operation).

### `ResultData` [out]

The arbitrary data returned by the extended operation (if **NULL**, no data is returned by the server).

### `Freeit` [in]

Determines whether the *ResultMessage* parameter is freed. You can pass any nonzero value to the *Freeit* parameter to free the *ResultMessage* pointer when it is no longer needed, or you can call
[ldap_msgfree](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_msgfree) to free the result later.

## Return value

If the function succeeds, the return value is **LDAP_SUCCESS**.

If the function fails, it returns an error code. See
[Return Values](https://learn.microsoft.com/previous-versions/windows/desktop/ldap/return-values) for more information.

## Remarks

When a server processes an extended operation request generated by
[ldap_extended_operation](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_extended_operation), it returns an LDAP message along with an **LDAP_RES_EXTENDED** return code. Use **ldap_parse_extended_result** to parse this result message, which returns both the text OID of the originating message in *ResultOID* and any arbitrary data generated by the extended operation in *ResultData*.

When they are no longer needed, free the *ResultOID* string and the *ResultData* buffer by calling
[ldap_memfree](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_memfree).

> [!NOTE]
> The winldap.h header defines ldap_parse_extended_result as an alias that automatically selects the ANSI or Unicode version of this function based on the definition of the UNICODE preprocessor constant. Mixing usage of the encoding-neutral alias with code that is not encoding-neutral can lead to mismatches that result in compilation or runtime errors. For more information, see [Conventions for Function Prototypes](https://learn.microsoft.com/windows/win32/intl/conventions-for-function-prototypes).

## See also

[Functions](https://learn.microsoft.com/previous-versions/windows/desktop/ldap/functions)

[LDAPMessage](https://learn.microsoft.com/windows/desktop/api/winldap/ns-winldap-ldapmessage)

[Return Values](https://learn.microsoft.com/previous-versions/windows/desktop/ldap/return-values)

[ldap_extended_operation](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_extended_operation)

[ldap_memfree](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_memfree)

[ldap_msgfree](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_msgfree)

[ldap_result](https://learn.microsoft.com/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result)